<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width,initial-scale=1"><meta charset="utf-8"><link rel="stylesheet" type="text/css" href="css/normalize.css"><link rel="stylesheet" type="text/css" href="css/perfect-scrollbar.css"><link rel="stylesheet" type="text/css" href="css/highlightjs/night-owl.css"><link rel="stylesheet" type="text/css" href="index.css"><title>README | bfxfixgw</title></head><body><div id="bfx-oss-docs-side-bar"><div id="bfx-oss-docs-side-bar__header"><img src="img/bfx-logo-bg-white.png" alt="Bitfinex" height="63"></div><ul><li><a href="index.html"><p>Home</p></a></li><li><a href="page_md_render_test.html"><p>Markdown Render Test</p></a></li><li><a href="/page_libraries_bitfinex_api_py_README.html"><img src="svg/icons/python.svg"><p>bitfinex-api-py</p></a></li><li><a href="/page_libraries_bitfinex_api_go_README.html"><img src="svg/icons/go.svg"><p>bitfinex-api-go</p></a></li><li class="active"><a href="/page_libraries_bfxfixgw_README.html"><img src="svg/icons/go.svg"><p>bfxfixgw</p></a><ul><li class="active"><a href="page_libraries_bfxfixgw_README.html"><p>- README</p></a></li></ul></li><li><a href="/page_libraries_bitfinex_api_rb_README.html"><img src="svg/icons/ruby.svg"><p>bitfinex-api-rb</p></a></li><li><a href="/page_libraries_bitfinex_api_node_README.html"><img src="svg/icons/nodejs_small.svg"><p>bitfinex-api-node</p></a></li><li><a href="/page_libraries_bfx_api_mock_srv_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-mock-srv</p></a></li><li><a href="/page_libraries_bfx_api_node_core_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-core</p></a></li><li><a href="/page_libraries_bfx_api_node_models_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-models</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_example_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-example</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_managed_candles_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-managed-candles</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_managed_ob_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-managed-ob</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_ob_checksum_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-ob-checksum</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_seq_audit_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-seq-audit</p></a></li><li><a href="/page_libraries_bfx_api_node_plugin_wd_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-plugin-wd</p></a></li><li><a href="/page_libraries_bfx_api_node_rest_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-rest</p></a></li><li><a href="/page_libraries_bfx_api_node_util_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-util</p></a></li><li><a href="/page_libraries_bfx_api_node_ws1_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-api-node-ws1</p></a></li><li><a href="/page_libraries_bfx_hf_backtest_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-backtest</p></a></li><li><a href="/page_libraries_bfx_hf_chart_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-chart</p></a></li><li><a href="/page_libraries_bfx_hf_data_server_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-data-server</p></a></li><li><a href="/page_libraries_bfx_hf_ext_plugin_bitfinex_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-ext-plugin-bitfinex</p></a></li><li><a href="/page_libraries_bfx_hf_ext_plugin_dummy_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-ext-plugin-dummy</p></a></li><li><a href="/page_libraries_bfx_hf_indicators_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-indicators</p></a></li><li><a href="/page_libraries_bfx_hf_models_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models</p></a></li><li><a href="/page_libraries_bfx_hf_models_adapter_lowdb_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-lowdb</p></a></li><li><a href="/page_libraries_bfx_hf_models_adapter_sql_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-sql</p></a></li><li><a href="/page_libraries_bfx_hf_models_adapter_template_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-models-adapter-template</p></a></li><li><a href="/page_libraries_bfx_hf_algo_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-algo</p></a></li><li><a href="/page_libraries_bfx_hf_server_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-server</p></a></li><li><a href="/page_libraries_bfx_hf_strategy_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-strategy</p></a></li><li><a href="/page_libraries_bfx_hf_strategy_exec_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-strategy-exec</p></a></li><li><a href="/page_libraries_bfx_hf_ui_config_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-ui-config</p></a></li><li><a href="/page_libraries_bfx_hf_util_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-hf-util</p></a></li><li><a href="/page_libraries_bfx_ws2_api_audit_README.html"><img src="svg/icons/nodejs_small.svg"><p>bfx-ws2-api-audit</p></a></li><li><a href="/page_libraries_cbq_js_README.html"><img src="svg/icons/nodejs_small.svg"><p>cbq-js</p></a></li><li><a href="/page_libraries_caron_README.html"><img src="svg/icons/nodejs_small.svg"><p>caron</p></a></li><li><a href="/page_libraries_eos_name_verify_README.html"><img src="svg/icons/nodejs_small.svg"><p>eos-name-verify</p></a></li><li><a href="/page_libraries_grenache_browser_http_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-browser-http</p></a></li><li><a href="/page_libraries_grenache_grape_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-grape</p></a></li><li><a href="/page_libraries_grenache_nodejs_base_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-base</p></a></li><li><a href="/page_libraries_grenache_nodejs_http_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-http</p></a></li><li><a href="/page_libraries_grenache_nodejs_link_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-link</p></a></li><li><a href="/page_libraries_grenache_nodejs_utp_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-utp</p></a></li><li><a href="/page_libraries_grenache_nodejs_ws_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-ws</p></a></li><li><a href="/page_libraries_grenache_nodejs_ws_tls_README.html"><img src="svg/icons/nodejs_small.svg"><p>grenache-nodejs-ws-tls</p></a></li><li><a href="/page_libraries_lib_js_util_currencies_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-currencies</p></a></li><li><a href="/page_libraries_lib_js_util_math_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-math</p></a></li><li><a href="/page_libraries_lib_js_util_number_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-number</p></a></li><li><a href="/page_libraries_lib_js_util_symbol_README.html"><img src="svg/icons/nodejs_small.svg"><p>lib-js-util-symbol</p></a></li><li><a href="/page_libraries_smidgen_README.html"><img src="svg/icons/nodejs_small.svg"><p>smidgen</p></a></li><li><a href="/page_libraries_sunbeam_README.html"><img src="svg/icons/nodejs_small.svg"><p>sunbeam</p></a></li><li><a href="/page_libraries_wasteland_README.html"><img src="svg/icons/nodejs_small.svg"><p>wasteland</p></a></li></ul></div><div id="bfx-oss-docs-content"><div id="bfx-oss-docs-header-bar"><h2>README</h2><h2>bfxfixgw</h2></div><div id="bfx-oss-docs-content-wrapper" class="bfx-oss-docs-content-type-api-docs"><div class="bfx-oss-docs-md-content bfx-oss-docs-code-wrapper"><div id="bfx-oss-docs-api-docs-index"><div id="bfx-oss-docs-api-docs-index__inner"><nav class="bfx-oss-docs-md-toc"><ol><li><a href="#bitfinex-fix-gateway">Bitfinex FIX Gateway</a><ol><li><a href="#build">Build</a><ol><li><a href="#go-environment">Go Environment</a></li><li><a href="#building-source-changes">Building Source Changes</a></li></ol></li><li><a href="#configuration">Configuration</a><ol><li><a href="#environment">Environment</a></li><li><a href="#sessions">Sessions</a><ol><li><a href="#sequence-numbers">Sequence Numbers</a></li></ol></li><li><a href="#fix-configuration-examples">FIX Configuration Examples</a></li><li><a href="#gateway-startup">Gateway Startup</a></li></ol></li><li><a href="#authentication">Authentication</a></li><li><a href="#testing-using-fix_client">Testing using fix_client</a><ol><li><a href="#configuring-fix_client">Configuring fix_client</a></li><li><a href="#running-fix_client-example">Running fix_client Example</a></li></ol></li><li><a href="#market-data-distribution">Market Data Distribution</a><ol><li><a href="#examples">Examples</a></li></ol></li><li><a href="#order-routing">Order Routing</a><ol><li><a href="#examples-2">Examples</a></li></ol></li><li><a href="#order-state-details">Order State Details</a><ol><li><a href="#order-update-status-mappings">Order Update Status Mappings</a></li><li><a href="#synthetic-order-state-message-mappings">Synthetic Order State Message Mappings</a></li></ol></li><li><a href="#troubleshooting">Troubleshooting</a><ol><li><a href="#fix-client-won%E2%80%99t-log-on">FIX client won’t log on</a></li><li><a href="#fix-logs-on-but-does-not-process-requests">FIX logs on but does not process requests</a></li></ol></li></ol></li><li><a href="#issues">Issues</a><ol><li><a href="#average-prices-%26-working-quantities-for-out-of-session-working-orders">Average prices &amp; working quantities for out-of-session working orders</a></li><li><a href="#execution-reports-out-of-order">Execution reports out of order</a></li><li><a href="#immediate-or-cancel-collapses-into-fill-or-kill-time-in-force">Immediate or Cancel collapses into Fill or Kill time in force</a></li><li><a href="#unsolicited-trailing-stop-execution-report-missing-trailing-peg">Unsolicited trailing stop Execution Report missing trailing peg</a></li></ol></li></ol></nav></div></div><p><a href="https://travis-ci.org/bitfinexcom/bfxfixgw.svg?branch=master"><img src="https://api.travis-ci.org/bitfinexcom/bfxfixgw.png?branch=master" alt="Build Status"></a></p><h1 id="bitfinex-fix-gateway"><a class="header-anchor" href="#bitfinex-fix-gateway">§</a> Bitfinex FIX Gateway</h1><p>The Bitfinex FIX gateway uses <a href="https://github.com/quickfixgo/quickfix">QuickFix/go</a> to implement FIX connectivity. <a href="https://github.com/bitfinexcom/bitfinex-api-go">The Bitfinex Go API</a> is used to manage the <a href="https://bitfinex.readme.io/docs">Bitfinex API websocket</a> connection, which ultimately uses <a href="https://github.com/gorilla/websocket">Gorilla</a>.</p><h2 id="build"><a class="header-anchor" href="#build">§</a> Build</h2><h3 id="go-environment"><a class="header-anchor" href="#go-environment">§</a> Go Environment</h3><p>If one does not already exist, install a Go environment by following <a href="https://golang.org/doc/install">these instructions</a>. If GOPATH is set to ~/go and the bfxfixgw repository is cloned to ~/go/src/github.com/bitfinexcom/bfxfixgw, then the following simple go command is all that is needed if issued from the ~/go directory. Both bfxfixgw and fix_client will be installed to ~/go/bin after issuing the command.</p><p>Obtain all additional sources, build, and install:</p><pre><code class="hljs language-bash">go get ./...
</code></pre><h3 id="building-source-changes"><a class="header-anchor" href="#building-source-changes">§</a> Building Source Changes</h3><p>Local bfxfixgw source changes can be built by issuing the following commands from the ~/go/src/github.com/bitfinexcom/bfxfixgw directory. The install command will copy the latest version of bfxfixgw and fix_client to ~/go/bin.</p><p>Test:</p><pre><code class="hljs language-bash">make check
</code></pre><p>Linter:</p><pre><code class="hljs language-bash">make lint
</code></pre><p>Build:</p><pre><code class="hljs language-bash">make build
</code></pre><p>And install binaries:</p><pre><code class="hljs language-bash">make install
</code></pre><p>Or do all above steps:</p><pre><code class="hljs language-bash">make all
</code></pre><h2 id="configuration"><a class="header-anchor" href="#configuration">§</a> Configuration</h2><p>The FIX gateway can operate in order routing mode, market data mode, or both. Order routing &amp; market data FIX endpoints must be separate with distinct session IDs.</p><h3 id="environment"><a class="header-anchor" href="#environment">§</a> Environment</h3><ul><li><code>DEBUG=1</code> to enable debug logging</li><li><code>FIX_SETTINGS_DIRECTORY=./config</code> to read the configs from the given directory, <code>./config</code> is the default directory.</li></ul><h3 id="sessions"><a class="header-anchor" href="#sessions">§</a> Sessions</h3><p>Sessions must be known to the FIX gateway prior to startup. A FIX gateway can manage any number of sessions. Each FIX session will create 1 websocket proxy connection.</p><h4 id="sequence-numbers"><a class="header-anchor" href="#sequence-numbers">§</a> Sequence Numbers</h4><p>The market data FIX service does not support resend requests or replaying FIX messages. When connecting to the market data FIX endpoint, a FIX initiator must have the correct sequence number, or a lower than expected sequence number.</p><p>The order routing service strictly tracks sequence numbers and does support message storage. A FIX initiator can send <code>ResetSeqNumFlag=Y</code> on Logon to reset session sequence numbers.</p><h3 id="fix-configuration-examples"><a class="header-anchor" href="#fix-configuration-examples">§</a> FIX Configuration Examples</h3><p>Example service FIX session configuration for a market data service:</p><pre><code class="hljs"><span class="hljs-section">[DEFAULT]</span>
<span class="hljs-attr">SenderCompID</span>=BFXFIX
<span class="hljs-attr">ResetOnLogon</span>=Y
<span class="hljs-attr">ReconnectInterval</span>=<span class="hljs-number">60</span>
<span class="hljs-attr">FileLogPath</span>=tmp/md_service/log
<span class="hljs-attr">SocketAcceptPort</span>=<span class="hljs-number">5001</span>
<span class="hljs-attr">StartTime</span>=<span class="hljs-number">00</span>:<span class="hljs-number">05</span>:<span class="hljs-number">00</span>
<span class="hljs-attr">StartDay</span>=Sun
<span class="hljs-attr">EndTime</span>=<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>
<span class="hljs-attr">EndDay</span>=Sun

<span class="hljs-section">[SESSION]</span>
<span class="hljs-attr">TargetCompID</span>=EXORG_MD
<span class="hljs-attr">BeginString</span>=FIX.<span class="hljs-number">4.2</span>
<span class="hljs-attr">DefaultApplVerID</span>=FIX.<span class="hljs-number">4.2</span>
<span class="hljs-attr">HeartBtInt</span>=<span class="hljs-number">30</span>
</code></pre><p>Example service FIX session configuration for an order routing service:</p><pre><code class="hljs"><span class="hljs-section">[DEFAULT]</span>
<span class="hljs-attr">SenderCompID</span>=BFXFIX
<span class="hljs-attr">ReconnectInterval</span>=<span class="hljs-number">60</span>
<span class="hljs-attr">FileLogPath</span>=tmp/ord_service/log
<span class="hljs-attr">FileStorePath</span>=tmp/ord_service/data
<span class="hljs-attr">SocketAcceptPort</span>=<span class="hljs-number">5002</span>
<span class="hljs-attr">StartTime</span>=<span class="hljs-number">00</span>:<span class="hljs-number">05</span>:<span class="hljs-number">00</span>
<span class="hljs-attr">StartDay</span>=Sun
<span class="hljs-attr">EndTime</span>=<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>
<span class="hljs-attr">EndDay</span>=Sun

<span class="hljs-section">[SESSION]</span>
<span class="hljs-attr">TargetCompID</span>=EXORG_ORD
<span class="hljs-attr">BeginString</span>=FIX.<span class="hljs-number">4.2</span>
<span class="hljs-attr">DefaultApplVerID</span>=FIX.<span class="hljs-number">4.2</span>
<span class="hljs-attr">HeartBtInt</span>=<span class="hljs-number">30</span>
</code></pre><h3 id="gateway-startup"><a class="header-anchor" href="#gateway-startup">§</a> Gateway Startup</h3><p>To startup the gateway in verbose mode (-v) with both order routing and market data endpoints (staging configuration) run the following command:</p><pre><code class="hljs language-bash">FIX_SETTINGS_DIRECTORY=~/go/src/github.com/bitfinexcom/bfxfixgw/conf/integration_test/service ~/go/bin/bfxfixgw -v -orders -ordcfg <span class="hljs-string">"orders_fix42.cfg"</span> -md -mdcfg <span class="hljs-string">"marketdata_fix42.cfg"</span> -rest <span class="hljs-string">"https://api.bitfinex.com/v2/"</span> -ws <span class="hljs-string">"wss://api.bitfinex.com/ws/2"</span>
</code></pre><h2 id="authentication"><a class="header-anchor" href="#authentication">§</a> Authentication</h2><p>FIX session information must be obtained prior to a FIX client establishing a connection. The pre-determined TargetCompID, SenderCompID, and FIX version strings should be configured in the FIX client configuration.</p><p>Once sessions are configured, a FIX client can authenticate by adding the Bitfinex User ID, API key, and API secret into the FIX <code>35=A Logon</code> message body:</p><table><thead><tr><th>Field</th><th>FIX Tag #</th><th>Description</th></tr></thead><tbody><tr><td>BfxApiKey</td><td>20000</td><td>User’s API Key</td></tr><tr><td>BfxApiSecret</td><td>20001</td><td>User’s API Secret</td></tr><tr><td>BfxUserID</td><td>20002</td><td>User’s Bfx ID</td></tr></tbody></table><p>Optionally, a user can request all session-level orders be canceled when the FIX session is disconnected by setting the following FIX tag <code>8013=Y</code>:</p><table><thead><tr><th>Field</th><th>FIX Tag #</th><th>Description</th></tr></thead><tbody><tr><td>CancelOnDisconnect</td><td>8013</td><td>Cancel session orders on FIX disconnect</td></tr></tbody></table><hr><p><strong>Note:</strong> FIX clients should use separate API keys for market data and order routing FIX endpoints.</p><hr><p>These tags are supported by the gateway’s default <a href="spec/Bitfinex_FIX42.xml">data dictionary</a>. An example staging logon message (<code>SOH</code> replaced with <code>|</code>):</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">186</span>|<span class="hljs-number">35</span>=A|<span class="hljs-number">34</span>=<span class="hljs-number">1</span>|<span class="hljs-number">49</span>=EXORG_ORD|<span class="hljs-number">52</span>=<span class="hljs-number">20180416</span><span class="hljs-number">-18</span>:<span class="hljs-number">27</span>:<span class="hljs-number">47.541</span>|<span class="hljs-number">56</span>=BFXFIX|<span class="hljs-number">20000</span>=U83q9jkML2GVj1fVxFJOAXQeDGaXIzeZ6PwNPQLEXt4|<span class="hljs-number">20001</span>=<span class="hljs-number">77</span>SWIRggvw0rCOJUgk9GVcxbldjTxOJP5WLCjWBFIVc|<span class="hljs-number">20002</span>=connamara|<span class="hljs-number">98</span>=<span class="hljs-number">0</span>|<span class="hljs-number">108</span>=<span class="hljs-number">30</span>|<span class="hljs-number">10</span>=<span class="hljs-number">117</span>|
</code></pre><h2 id="testing-using-fix_client"><a class="header-anchor" href="#testing-using-fix_client">§</a> Testing using fix_client</h2><p>The project includes a test client utility called fix_client. fix_client is a simple gateway client that demonstrates a subset of gateway functionality. The client currently supports sending and canceling orders via the gateway. Simply run the client, issue a root command (either nos or cxl), and then provide additional request parameters as prompted.</p><h3 id="configuring-fix_client"><a class="header-anchor" href="#configuring-fix_client">§</a> Configuring fix_client</h3><p>The fix_client takes a quickfix configuration file located here ~/go/src/github.com/bitfinexcom/bfxfixgw/conf/integration_test/client/orders_fix42.cfg. To successfully connect to BFX using the gateway, you must change the following parameters to match the API access of your account. Please note the security risk of adding credentials to this file in plain text. You may want to remove these values after you are done with testing using fix_client</p><pre><code class="hljs">ApiKey=[Use<span class="hljs-string">r's API Key]  
ApiSecret=[User'</span>s API Secret]  
BfxUserID=[Use<span class="hljs-string">r's Bfx ID]  
</span></code></pre><h3 id="running-fix_client-example"><a class="header-anchor" href="#running-fix_client-example">§</a> Running fix_client Example</h3><p>Here is an example of using fix_client to place a market order. All outgoing and incoming FIX traffic is logged. You can decode the FIX manually or using your favorite FIX parser. Please be careful to avoid sending FIX logs that contain private keys to online parsers. Some logging has been stripped out for clarity and user input is <strong>bold</strong>.</p><blockquote><p><strong>./fix_client -cfg …/src/github.com/bitfinexcom/bfxfixgw/conf/integration_test/client/orders_fix42.cfg</strong><br>Enter command:<br><strong>nos</strong><br>-&gt; New Order Single<br>Enter ClOrdID (integer):<br><strong>1</strong><br>Enter symbol:<br><strong>tBTCUSD</strong><br>Enter order type:<br><strong>market</strong><br>Enter qty:<br><strong>0.05</strong><br>Enter side:<br><strong>buy</strong><br>Options? (hidden, postonly, fok): [FIX Client] MockFix.ToApp (outgoing): 8=FIX.4.2|9=126|35=D|34=547|49=EXORG_ORD|52=20180504-16:45:04.697|56=BFXFIX|11=1|21=3|38=0.0500|40=1|54=1|55=tBTCUSD|60=20180504-16:45:03.518|10=249|<br>[FIX Client] MockFix.FromApp (incoming): 8=FIX.4.2|9=221|35=8|34=550|49=BFXFIX|52=20180504-16:45:04.804|56=EXORG_ORD|1=connamara|6=0.00|11=1|14=0.0000|17=43a98b1d-0312-41cf-9678-33e268e9bff9|20=3|32=0.0000|37=1149703695|38=0.0500|39=0|40=1|54=1|55=tBTCUSD|59=1|150=0|151=0.0500|10=007|<br>&lt;2018-05-04 16:45:05.823298994 +0000 UTC, FIX.4.2:EXORG_ORD-&gt;BFXFIX, incoming&gt;<br>[FIX Client] MockFix.FromApp (incoming): 8=FIX.4.2|9=250|35=8|34=551|49=BFXFIX|52=20180504-16:45:05.818|56=EXORG_ORD|1=connamara|6=850.00|11=1|12=0.0001|13=3|14=0.0500|17=1cfb00fc-9ea6-4dca-8d9f-a5cce1cc0959|20=3|31=850.0000|32=0.0500|37=1149703695|38=0.0500|39=2|40=1|54=1|55=tBTCUSD|59=1|150=2|151=0.0000|10=182</p></blockquote><h2 id="market-data-distribution"><a class="header-anchor" href="#market-data-distribution">§</a> Market Data Distribution</h2><p>The FIX gateway service may be configured to distribute market data. Starting the process with <code>-md</code> will enable market data distribution, configured by the <code>-mdcfg</code> flag.</p><h3 id="examples"><a class="header-anchor" href="#examples">§</a> Examples</h3><p>Subscribe to <code>tBTCUSD</code> top-of-book Precision0 updates:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">111</span>|<span class="hljs-number">35</span>=V|<span class="hljs-number">34</span>=<span class="hljs-number">2</span>|<span class="hljs-number">49</span>=EXORG_MD|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-19</span>:<span class="hljs-number">40</span>:<span class="hljs-number">17.467</span>|<span class="hljs-number">56</span>=BFXFIX|<span class="hljs-number">146</span>=<span class="hljs-number">1</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">262</span>=req-tBTCUSD|<span class="hljs-number">263</span>=<span class="hljs-number">1</span>|<span class="hljs-number">264</span>=<span class="hljs-number">1</span>|<span class="hljs-number">20003</span>=P0|<span class="hljs-number">10</span>=<span class="hljs-number">167</span>|
</code></pre><p>Subscribe to <code>tETHUSD</code> full raw book updates at 25 price levels:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">112</span>|<span class="hljs-number">35</span>=V|<span class="hljs-number">34</span>=<span class="hljs-number">3</span>|<span class="hljs-number">49</span>=EXORG_MD|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-19</span>:<span class="hljs-number">46</span>:<span class="hljs-number">44.594</span>|<span class="hljs-number">56</span>=BFXFIX|<span class="hljs-number">146</span>=<span class="hljs-number">1</span>|<span class="hljs-number">55</span>=tETHUSD|<span class="hljs-number">262</span>=req-tETHUSD|<span class="hljs-number">263</span>=<span class="hljs-number">1</span>|<span class="hljs-number">264</span>=<span class="hljs-number">25</span>|<span class="hljs-number">20003</span>=R0|<span class="hljs-number">10</span>=<span class="hljs-number">248</span>|
</code></pre><p>Receive FIX <code>35=W</code> book snapshot (for the first tBTCUSD request):</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">168</span>|<span class="hljs-number">35</span>=W|<span class="hljs-number">34</span>=<span class="hljs-number">3</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-19</span>:<span class="hljs-number">40</span>:<span class="hljs-number">21.294</span>|<span class="hljs-number">56</span>=EXORG_MD|<span class="hljs-number">22</span>=<span class="hljs-number">8</span>|<span class="hljs-number">48</span>=tBTCUSD|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">262</span>=req-tBTCUSD|<span class="hljs-number">268</span>=<span class="hljs-number">2</span>|<span class="hljs-number">269</span>=<span class="hljs-number">0</span>|<span class="hljs-number">270</span>=<span class="hljs-number">1663.9000</span>|<span class="hljs-number">271</span>=<span class="hljs-number">0.0400</span>|<span class="hljs-number">269</span>=<span class="hljs-number">1</span>|<span class="hljs-number">270</span>=<span class="hljs-number">1670.8000</span>|<span class="hljs-number">271</span>=<span class="hljs-number">0.1000</span>|<span class="hljs-number">10</span>=<span class="hljs-number">242</span>|
</code></pre><p>Receive FIX <code>35=X</code> market data incremental update (for the first tBTCUSD request):</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">140</span>|<span class="hljs-number">35</span>=X|<span class="hljs-number">34</span>=<span class="hljs-number">5</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-19</span>:<span class="hljs-number">41</span>:<span class="hljs-number">48.474</span>|<span class="hljs-number">56</span>=EXORG_MD|<span class="hljs-number">262</span>=req-tBTCUSD|<span class="hljs-number">268</span>=<span class="hljs-number">1</span>|<span class="hljs-number">279</span>=<span class="hljs-number">2</span>|<span class="hljs-number">269</span>=<span class="hljs-number">1</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">48</span>=tBTCUSD|<span class="hljs-number">22</span>=<span class="hljs-number">8</span>|<span class="hljs-number">270</span>=<span class="hljs-number">0.0000</span>|<span class="hljs-number">271</span>=<span class="hljs-number">1.0000</span>|<span class="hljs-number">10</span>=<span class="hljs-number">185</span>|
</code></pre><p>Receive FIX <code>35=X</code> trade incremental update (for the first tBTCUSD request):</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">143</span>|<span class="hljs-number">35</span>=X|<span class="hljs-number">34</span>=<span class="hljs-number">5</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-21</span>:<span class="hljs-number">25</span>:<span class="hljs-number">27.455</span>|<span class="hljs-number">56</span>=EXORG_MD|<span class="hljs-number">262</span>=req-tBTCUSD|<span class="hljs-number">268</span>=<span class="hljs-number">1</span>|<span class="hljs-number">279</span>=<span class="hljs-number">0</span>|<span class="hljs-number">269</span>=<span class="hljs-number">2</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">48</span>=tBTCUSD|<span class="hljs-number">22</span>=<span class="hljs-number">8</span>|<span class="hljs-number">270</span>=<span class="hljs-number">1671.0000</span>|<span class="hljs-number">271</span>=<span class="hljs-number">0.1000</span>|<span class="hljs-number">10</span>=<span class="hljs-number">081</span>|
</code></pre><p>Receive FIX <code>35=AP</code> wallet snapshot and/or update</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">190</span>|<span class="hljs-number">35</span>=AP|<span class="hljs-number">34</span>=<span class="hljs-number">2</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20190801</span><span class="hljs-number">-19</span>:<span class="hljs-number">29</span>:<span class="hljs-number">05.679</span>|<span class="hljs-number">56</span>=EXORG_ORD|<span class="hljs-number">1</span>=user123|<span class="hljs-number">15</span>=fUSD|<span class="hljs-number">581</span>=exchange|<span class="hljs-number">715</span>=<span class="hljs-number">20190801</span>|<span class="hljs-number">721</span>=fd96bcd8<span class="hljs-number">-0133</span><span class="hljs-number">-4740</span>-a1e1<span class="hljs-number">-044f</span>eddd1be7|<span class="hljs-number">730</span>=<span class="hljs-number">1123.4500</span>|<span class="hljs-number">731</span>=<span class="hljs-number">1</span>|<span class="hljs-number">734</span>=<span class="hljs-number">1234.5600</span>|<span class="hljs-number">746</span>=<span class="hljs-number">10.0000</span>|<span class="hljs-number">10</span>=<span class="hljs-number">099</span>|
</code></pre><p>Receive FIX <code>35=AP</code> balance update</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">184</span>|<span class="hljs-number">35</span>=AP|<span class="hljs-number">34</span>=<span class="hljs-number">2</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20190801</span><span class="hljs-number">-19</span>:<span class="hljs-number">31</span>:<span class="hljs-number">26.318</span>|<span class="hljs-number">56</span>=EXORG_ORD|<span class="hljs-number">1</span>=user123|<span class="hljs-number">15</span>=all|<span class="hljs-number">581</span>=balance|<span class="hljs-number">715</span>=<span class="hljs-number">20190801</span>|<span class="hljs-number">721</span>=fcefabf1<span class="hljs-number">-13</span>b2<span class="hljs-number">-4f</span>06<span class="hljs-number">-8015</span><span class="hljs-number">-521109</span>c640de|<span class="hljs-number">730</span>=<span class="hljs-number">12.3400</span>|<span class="hljs-number">731</span>=<span class="hljs-number">1</span>|<span class="hljs-number">734</span>=<span class="hljs-number">123.4500</span>|<span class="hljs-number">746</span>=<span class="hljs-number">0.0000</span>|<span class="hljs-number">10</span>=<span class="hljs-number">139</span>|
</code></pre><h2 id="order-routing"><a class="header-anchor" href="#order-routing">§</a> Order Routing</h2><p>Order routing can be enabled with the <code>-ord</code> and <code>-ordcfg</code> flags on startup.</p><p>The following table lists Bitfinex order type support in the FIX gateway:</p><table><thead><tr><th>Order Type</th><th style="text-align:center">FIX 4.2</th><th style="text-align:center">FIX 4.4</th><th style="text-align:center">FIX 5.0</th></tr></thead><tbody><tr><td>Market</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td></tr><tr><td>Limit</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td></tr><tr><td>Stop</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td></tr><tr><td>Stop Limit</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td></tr><tr><td>Trailing Stop</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td><td style="text-align:center">✔</td></tr></tbody></table><p>Below is a table of various Bitfinex order features and their FIX <code>35=D NewOrderSingle</code> tags:</p><table><thead><tr><th>Bitfinex Order Feature</th><th>FIX Tag</th><th>FIX Tag Value</th></tr></thead><tbody><tr><td>Hidden</td><td>DisplayMethod (1084)</td><td>Undisclosed (4)</td></tr><tr><td>Post-Only<sup>*</sup></td><td>ExecInst (18)</td><td>Participate don’t initiate (6)</td></tr><tr><td>One Cancels Other (OCO)</td><td>ContingencyType (1385)</td><td>One Cancels the Other (1)</td></tr><tr><td>Fill or Kill</td><td>TimeInForce (59)</td><td>Fill or Kill (4)</td></tr><tr><td>Good till Date</td><td>TimeInForce (59)</td><td>Good till Date (6)</td></tr><tr><td>Good till Date</td><td>ExpireTime (126)</td><td>Example: 2006-01-02 15:04:05</td></tr><tr><td>Margin<sup>*</sup></td><td>CashMargin (544)</td><td>Margin Open (2)</td></tr><tr><td>Leverage</td><td>Leverage (20005)</td><td>Example: 10 (INTEGER)</td></tr></tbody></table><p><sup>*</sup> Post-Only orders are considered to have a Good-till-Cancel time in force.</p><p><sup>*</sup> Margin order execution reports respond with CashMargin (544) = Margin Close (3)</p><p>For a trailing stop order:</p><table><thead><tr><th>Trailing Stop Feature</th><th>FIX Tag</th><th>FIX Tag Value</th></tr></thead><tbody><tr><td>Order Type</td><td>OrdType (40)</td><td>Stop (3) or Stop Limit (4)</td></tr><tr><td>Execute as Trailing Peg</td><td>ExecInst (18)</td><td>Primary Peg ®</td></tr><tr><td>Trailing Peg Value</td><td>PegOffsetValue (211)</td><td>Price<sup>*</sup></td></tr></tbody></table><p><sup>*</sup> The trailing stop price should be in the same units as a Price (44) or StopPx (99).</p><p>e.g. For a trailing stop order where the stop should trail the market by $5.25, the following FIX tags should be set:</p><table><thead><tr><th>Field</th><th>Tag</th><th>Value</th></tr></thead><tbody><tr><td>OrdType</td><td>40</td><td>4</td></tr><tr><td>ExecInst</td><td>18</td><td>R</td></tr><tr><td>PegOffsetValue</td><td>211</td><td>5.25</td></tr></tbody></table><h3 id="examples-2"><a class="header-anchor" href="#examples-2">§</a> Examples</h3><p>Send limit new order single:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">142</span>|<span class="hljs-number">35</span>=D|<span class="hljs-number">34</span>=<span class="hljs-number">34</span>|<span class="hljs-number">49</span>=EXORG_ORD|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">28</span>:<span class="hljs-number">26.326</span>|<span class="hljs-number">56</span>=BFXFIX|<span class="hljs-number">11</span>=<span class="hljs-number">2000</span>|<span class="hljs-number">21</span>=<span class="hljs-number">3</span>|<span class="hljs-number">38</span>=<span class="hljs-number">0.1000</span>|<span class="hljs-number">40</span>=<span class="hljs-number">2</span>|<span class="hljs-number">44</span>=<span class="hljs-number">20000.0000</span>|<span class="hljs-number">54</span>=<span class="hljs-number">2</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">60</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">28</span>:<span class="hljs-number">26.326</span>|<span class="hljs-number">10</span>=<span class="hljs-number">208</span>|
</code></pre><p>Receive FIX <code>35=8</code> execution report for working order:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">232</span>|<span class="hljs-number">35</span>=<span class="hljs-number">8</span>|<span class="hljs-number">34</span>=<span class="hljs-number">38</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">28</span>:<span class="hljs-number">26.555</span>|<span class="hljs-number">56</span>=EXORG_ORD|<span class="hljs-number">1</span>=connamara|<span class="hljs-number">6</span>=<span class="hljs-number">0.00</span>|<span class="hljs-number">11</span>=<span class="hljs-number">2000</span>|<span class="hljs-number">14</span>=<span class="hljs-number">0.0000</span>|<span class="hljs-number">17</span>=<span class="hljs-number">935</span>a0300<span class="hljs-number">-2f</span>34<span class="hljs-number">-4908</span><span class="hljs-number">-9e03</span><span class="hljs-number">-6</span>b899f9718c6|<span class="hljs-number">20</span>=<span class="hljs-number">3</span>|<span class="hljs-number">32</span>=<span class="hljs-number">0.0000</span>|<span class="hljs-number">37</span>=<span class="hljs-number">1149698709</span>|<span class="hljs-number">38</span>=<span class="hljs-number">0.1000</span>|<span class="hljs-number">39</span>=<span class="hljs-number">0</span>|<span class="hljs-number">40</span>=<span class="hljs-number">2</span>|<span class="hljs-number">44</span>=<span class="hljs-number">20000.0000</span>|<span class="hljs-number">54</span>=<span class="hljs-number">2</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">150</span>=<span class="hljs-number">0</span>|<span class="hljs-number">151</span>=<span class="hljs-number">0.1000</span>|<span class="hljs-number">10</span>=<span class="hljs-number">097</span>|
</code></pre><p>Send market new order single:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">128</span>|<span class="hljs-number">35</span>=D|<span class="hljs-number">34</span>=<span class="hljs-number">39</span>|<span class="hljs-number">49</span>=EXORG_ORD|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">30</span>:<span class="hljs-number">34.310</span>|<span class="hljs-number">56</span>=BFXFIX|<span class="hljs-number">11</span>=<span class="hljs-number">2002</span>|<span class="hljs-number">21</span>=<span class="hljs-number">3</span>|<span class="hljs-number">38</span>=<span class="hljs-number">1.5000</span>|<span class="hljs-number">40</span>=<span class="hljs-number">1</span>|<span class="hljs-number">54</span>=<span class="hljs-number">2</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">60</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">30</span>:<span class="hljs-number">34.310</span>|<span class="hljs-number">10</span>=<span class="hljs-number">059</span>|
</code></pre><p>Receive FIX <code>35=8</code> execution report for a partial fill:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">249</span>|<span class="hljs-number">35</span>=<span class="hljs-number">8</span>|<span class="hljs-number">34</span>=<span class="hljs-number">45</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">30</span>:<span class="hljs-number">35.100</span>|<span class="hljs-number">56</span>=EXORG_ORD|<span class="hljs-number">1</span>=connamara|<span class="hljs-number">6</span>=<span class="hljs-number">1663.90</span>|<span class="hljs-number">11</span>=<span class="hljs-number">2002</span>|<span class="hljs-number">12</span>=<span class="hljs-number">0.1331</span>|<span class="hljs-number">13</span>=<span class="hljs-number">3</span>|<span class="hljs-number">14</span>=<span class="hljs-number">0.0400</span>|<span class="hljs-number">17</span>=f4d8af6e<span class="hljs-number">-04</span>ce<span class="hljs-number">-447</span>b<span class="hljs-number">-80</span>ed<span class="hljs-number">-3e82</span>d1476274|<span class="hljs-number">20</span>=<span class="hljs-number">3</span>|<span class="hljs-number">31</span>=<span class="hljs-number">1663.9000</span>|<span class="hljs-number">32</span>=<span class="hljs-number">0.0400</span>|<span class="hljs-number">37</span>=<span class="hljs-number">1149698710</span>|<span class="hljs-number">38</span>=<span class="hljs-number">1.5000</span>|<span class="hljs-number">39</span>=<span class="hljs-number">1</span>|<span class="hljs-number">40</span>=<span class="hljs-number">1</span>|<span class="hljs-number">54</span>=<span class="hljs-number">2</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">150</span>=<span class="hljs-number">1</span>|<span class="hljs-number">151</span>=<span class="hljs-number">1.4600</span>|<span class="hljs-number">10</span>=<span class="hljs-number">163</span>|
</code></pre><p>Receive the alst FIX <code>35=8</code> execution report for a full fill:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">249</span>|<span class="hljs-number">35</span>=<span class="hljs-number">8</span>|<span class="hljs-number">34</span>=<span class="hljs-number">48</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">30</span>:<span class="hljs-number">35.135</span>|<span class="hljs-number">56</span>=EXORG_ORD|<span class="hljs-number">1</span>=connamara|<span class="hljs-number">6</span>=<span class="hljs-number">1662.70</span>|<span class="hljs-number">11</span>=<span class="hljs-number">2002</span>|<span class="hljs-number">12</span>=<span class="hljs-number">0.3327</span>|<span class="hljs-number">13</span>=<span class="hljs-number">3</span>|<span class="hljs-number">14</span>=<span class="hljs-number">1.5000</span>|<span class="hljs-number">17</span>=<span class="hljs-number">6</span>ee60005<span class="hljs-number">-4e99</span><span class="hljs-number">-4e6</span>d-aa51<span class="hljs-number">-3</span>aa617489dc7|<span class="hljs-number">20</span>=<span class="hljs-number">3</span>|<span class="hljs-number">31</span>=<span class="hljs-number">1663.5000</span>|<span class="hljs-number">32</span>=<span class="hljs-number">0.1000</span>|<span class="hljs-number">37</span>=<span class="hljs-number">1149698710</span>|<span class="hljs-number">38</span>=<span class="hljs-number">1.5000</span>|<span class="hljs-number">39</span>=<span class="hljs-number">2</span>|<span class="hljs-number">40</span>=<span class="hljs-number">1</span>|<span class="hljs-number">54</span>=<span class="hljs-number">2</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">150</span>=<span class="hljs-number">2</span>|<span class="hljs-number">151</span>=<span class="hljs-number">0.0000</span>|<span class="hljs-number">10</span>=<span class="hljs-number">112</span>|
</code></pre><p>Cancel working limit order:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">116</span>|<span class="hljs-number">35</span>=F|<span class="hljs-number">34</span>=<span class="hljs-number">36</span>|<span class="hljs-number">49</span>=EXORG_ORD|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">29</span>:<span class="hljs-number">11.115</span>|<span class="hljs-number">56</span>=BFXFIX|<span class="hljs-number">11</span>=<span class="hljs-number">2001</span>|<span class="hljs-number">41</span>=<span class="hljs-number">2000</span>|<span class="hljs-number">54</span>=<span class="hljs-number">2</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">60</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">29</span>:<span class="hljs-number">11.115</span>|<span class="hljs-number">10</span>=<span class="hljs-number">051</span>|
</code></pre><p>Receive FIX <code>35=8</code> pending cancel acknowledgement:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">296</span>|<span class="hljs-number">35</span>=<span class="hljs-number">8</span>|<span class="hljs-number">34</span>=<span class="hljs-number">40</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">29</span>:<span class="hljs-number">11.290</span>|<span class="hljs-number">56</span>=EXORG_ORD|<span class="hljs-number">1</span>=connamara|<span class="hljs-number">6</span>=<span class="hljs-number">0.00</span>|<span class="hljs-number">11</span>=<span class="hljs-number">2000</span>|<span class="hljs-number">14</span>=<span class="hljs-number">0.0000</span>|<span class="hljs-number">17</span>=d067ff27<span class="hljs-number">-4182</span><span class="hljs-number">-454f</span><span class="hljs-number">-8</span>c51-bd08c09b5730|<span class="hljs-number">20</span>=<span class="hljs-number">3</span>|<span class="hljs-number">37</span>=<span class="hljs-number">1149698709</span>|<span class="hljs-number">38</span>=<span class="hljs-number">0.1000</span>|<span class="hljs-number">39</span>=<span class="hljs-number">6</span>|<span class="hljs-number">40</span>=<span class="hljs-number">2</span>|<span class="hljs-number">44</span>=<span class="hljs-number">20000.0000</span>|<span class="hljs-number">54</span>=<span class="hljs-number">2</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">58</span>=Submitted <span class="hljs-keyword">for</span> cancellation; waiting <span class="hljs-keyword">for</span> confirmation (ID: <span class="hljs-number">1149698709</span>).|<span class="hljs-number">150</span>=<span class="hljs-number">6</span>|<span class="hljs-number">151</span>=<span class="hljs-number">0.1000</span>|<span class="hljs-number">10</span>=<span class="hljs-number">112</span>|
</code></pre><p>Receive FIX <code>35=8</code> cancel acknowledgement:</p><pre><code class="hljs"><span class="hljs-number">8</span>=FIX<span class="hljs-number">.4</span><span class="hljs-number">.2</span>|<span class="hljs-number">9</span>=<span class="hljs-number">244</span>|<span class="hljs-number">35</span>=<span class="hljs-number">8</span>|<span class="hljs-number">34</span>=<span class="hljs-number">41</span>|<span class="hljs-number">49</span>=BFXFIX|<span class="hljs-number">52</span>=<span class="hljs-number">20180417</span><span class="hljs-number">-22</span>:<span class="hljs-number">29</span>:<span class="hljs-number">11.305</span>|<span class="hljs-number">56</span>=EXORG_ORD|<span class="hljs-number">1</span>=connamara|<span class="hljs-number">6</span>=<span class="hljs-number">0.00</span>|<span class="hljs-number">11</span>=<span class="hljs-number">2000</span>|<span class="hljs-number">14</span>=<span class="hljs-number">0.0000</span>|<span class="hljs-number">17</span>=a674d1b4<span class="hljs-number">-214e-408</span>a<span class="hljs-number">-8</span>cc1-fa364ecd8d97|<span class="hljs-number">20</span>=<span class="hljs-number">3</span>|<span class="hljs-number">32</span>=<span class="hljs-number">0.0000</span>|<span class="hljs-number">37</span>=<span class="hljs-number">1149698709</span>|<span class="hljs-number">38</span>=<span class="hljs-number">0.1000</span>|<span class="hljs-number">39</span>=<span class="hljs-number">4</span>|<span class="hljs-number">40</span>=<span class="hljs-number">2</span>|<span class="hljs-number">44</span>=<span class="hljs-number">20000.0000</span>|<span class="hljs-number">54</span>=<span class="hljs-number">2</span>|<span class="hljs-number">55</span>=tBTCUSD|<span class="hljs-number">58</span>=CANCELED|<span class="hljs-number">150</span>=<span class="hljs-number">4</span>|<span class="hljs-number">151</span>=<span class="hljs-number">0.0000</span>|<span class="hljs-number">10</span>=<span class="hljs-number">112</span>|
</code></pre><h2 id="order-state-details"><a class="header-anchor" href="#order-state-details">§</a> Order State Details</h2><p>When receiving a Bitfinex Order update object (on, ou, oc), the following tables demonstrate rules for mapping FIX tag <code>39 OrdStatus</code>:</p><h3 id="order-update-status-mappings"><a class="header-anchor" href="#order-update-status-mappings">§</a> Order Update Status Mappings</h3><table><thead><tr><th>BFX Order State</th><th>FIX OrdStatus Code</th><th>Order Status</th></tr></thead><tbody><tr><td>ACTIVE</td><td>0</td><td>NEW</td></tr><tr><td>EXECUTED</td><td>2</td><td>FILLED</td></tr><tr><td>PARTIALLY FILLED</td><td>1</td><td>PARTIALLY FILLED</td></tr><tr><td>CANCELED</td><td>4</td><td>CANCELED</td></tr></tbody></table><p>Executions are received as <code>te</code> TradeExecution messages and <code>tu</code> TradeUpdate messages. TradeExecution messages come first, but generally omit the order type, original price, fee, and some other fields. The gateway processes <code>tu</code> TradeUpdate messages as executions. When receiving a TradeUpdate, MsgType <code>8</code> ExecutionReports are generated following these rules:</p><ul><li>1 TradeUpdate message will create 1 ExecutionReport</li><li>Tag 37 OrderID is derived from the <code>tu</code> server-assigned ID</li><li>An order’s CID is mapped to a tag 11 ClOrdID</li><li>The gateway maintains an in-memory cache of ClOrdID -&gt; order information, including:<ul><li>Original order details (symbol, account, price, quantity, type, side)</li><li>Calculated state details (average fill price, total open quantity, total filled quantity)</li><li>Executions related to the original order</li><li>Cancel details related to a ClOrdID (original order ID, symbol, account, ClOrdID, and side)</li></ul></li><li>When receiving order state updates (rejection, fill, cancel acknowledgement), the cache must be referenced to provide FIX-required details</li><li>When receiving a TradeUpdate, if cached details indicate the incoming TradeUpdate would fully fill the order, the gateway will publish an ExecutionReport with an OrdStatus of FILLED.</li></ul><h3 id="synthetic-order-state-message-mappings"><a class="header-anchor" href="#synthetic-order-state-message-mappings">§</a> Synthetic Order State Message Mappings</h3><p><code>on-req</code> generally maps to PENDING NEW, with an exception for market orders, which do not receive subsequent <code>on</code> ack working messages.</p><table><thead><tr><th>BFX Order Type</th><th>Incoming BFX Message</th><th>FIX OrdStatus Code</th><th>Order Status</th><th>Notes</th></tr></thead><tbody><tr><td>EXCHANGE MARKET</td><td>n (on-req)</td><td>0</td><td>NEW</td><td>Market orders do not receive <code>on</code> messages.</td></tr><tr><td>EXCHANGE LIMIT</td><td>n (on-req)</td><td>0</td><td>PENDING NEW</td><td></td></tr><tr><td>EXCHANGE LIMIT</td><td>oc</td><td>4</td><td>CANCELED</td><td><code>oc</code> objects are also received for terminal order states, such as fills, in which case an <code>oc</code> will generate no FIX message</td></tr><tr><td>EXCHANGE LIMIT</td><td>ou</td><td>Depends on status</td><td>Depends on status</td><td></td></tr></tbody></table><h2 id="troubleshooting"><a class="header-anchor" href="#troubleshooting">§</a> Troubleshooting</h2><p>Below are a few common issues with simple procedures to resolve runtime problems:</p><h4 id="fix-client-won%E2%80%99t-log-on"><a class="header-anchor" href="#fix-client-won%E2%80%99t-log-on">§</a> FIX client won’t log on</h4><p>If the session has been rolled over or restarted, a FIX initiator may have a higher sequence number than its acceptor, which is an error condition. Simply reset the FIX initiator’s sequence number (deleting the sequence store file in QuickFIX works) and the initiator should no longer disconnect on logon.</p><h4 id="fix-logs-on-but-does-not-process-requests"><a class="header-anchor" href="#fix-logs-on-but-does-not-process-requests">§</a> FIX logs on but does not process requests</h4><p>Ensure the correct endpoint is configured for use. (i.e. MarketDataRequests should be sent to the FIX Market Data endpoint, and NewOrderSingle messages should be sent to the order routing endpoint).</p><h1 id="issues"><a class="header-anchor" href="#issues">§</a> Issues</h1><h2 id="average-prices-%26-working-quantities-for-out-of-session-working-orders"><a class="header-anchor" href="#average-prices-%26-working-quantities-for-out-of-session-working-orders">§</a> Average prices &amp; working quantities for out-of-session working orders</h2><p>Orders placed outside of the FIX trading session may sometimes have incorrect filled quantities (FIX tag 14 <code>CumQty</code>), remaining quantities (FIX tag 151 <code>LeavesQty</code>), and/or average prices (FIX tag 6 <code>AvgPx</code>). The gateway uses an order’s individual executions to calculate average prices, filled quantities, and remaining quantities on demand. The gateway does not receive working order execution details in order snapshots on client logon. Therefore, the gateway will attempt to go out-of-band, using the authenticated REST API, to fetch execution details for working orders. Out of band requests use the same API key as the orders websocket connection, and may suffer from internet routing race conditions. Occasionally the order trades endpoint will unexpectedly return an empty set, therefore execution details may not always be available to the gateway.</p><p>Internet routing race conditions could be solved with a future enhancement to the gateway to use yet another (third) API key for authenticated out-of-band REST requests.</p><h2 id="execution-reports-out-of-order"><a class="header-anchor" href="#execution-reports-out-of-order">§</a> Execution reports out of order</h2><p>To preserve fee information, <code>tu</code> API messages are used to populate execution reports. However, the API publishes <code>tu</code> messages out of order, so corresponding ERs may also be out of order.</p><h2 id="immediate-or-cancel-collapses-into-fill-or-kill-time-in-force"><a class="header-anchor" href="#immediate-or-cancel-collapses-into-fill-or-kill-time-in-force">§</a> Immediate or Cancel collapses into Fill or Kill time in force</h2><p>If an order is sent with an Immediate or Cancel time in force, the order will be mapped as a Bitfinex fill or kill limit order. Corresponding execution reports will indicate the order was placed as a fill or kill limit and not an IOC limit order.</p><h2 id="unsolicited-trailing-stop-execution-report-missing-trailing-peg"><a class="header-anchor" href="#unsolicited-trailing-stop-execution-report-missing-trailing-peg">§</a> Unsolicited trailing stop Execution Report missing trailing peg</h2><p>If a trailing stop order was placed outside of the FIX session, a <code>39=0 NEW</code> Execution Report will be missing the trailing stop peg price. The Bitfinex API currently does not return trailing stop peg prices on order new notification acknowledgements, but instead lists the calculated stop price, which is included in tag <code>99 StopPx</code> on the <code>39=0 NEW</code> ExecutionReport. Subsequent ExecutionReports related to the unsolicited trailing stop may also be missing the peg price until the gateway’s cache is updated from the Bitfinex API.</p></div></div><!--
      <div id="bfx-oss-docs-footer-bar">
        <div id="bfx-oss-docs-footer-bar__container">
          <p>Copyright © 2013-2020 iFinex Inc. All rights reserved.</p>
        </div>
      </div>
      --></div><script type="text/javascript" src="js/vendor/debug.min.js"></script><script type="text/javascript" src="js/vendor/lodash.min.js"></script><script type="text/javascript" src="js/vendor/zepto.min.js"></script><script type="text/javascript" src="js/vendor/perfect-scrollbar.min.js"></script><script type="text/javascript" src="js/main.js"></script></body></html>